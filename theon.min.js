/*! theon v - MIT license - https://github.com/h2non/theon */
(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.theon=t()}})(function(){var t,e,n;return function r(t,e,n){function o(s,u){if(!e[s]){if(!t[s]){var a=typeof require=="function"&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=e[s]={exports:{}};t[s][0].call(p.exports,function(e){var n=t[s][1][e];return o(n?n:e)},p,p.exports,r,t,e,n)}return e[s].exports}var i=typeof require=="function"&&require;for(var s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,n){e.exports=function(e,n,o){var i=t("lil-http");return i(e,function(t,e){o(t,r(n,e))})};function r(t,e){t.setOriginalResponse(e);t.setStatus(e.status);t.setStatusText(e.statusText);t.setHeaders(e.headers);if(e.data)t.setBody(e.data);return t}},{"lil-http":20}],2:[function(t,e,n){var r=typeof window!=="undefined";n.browser={embed:t("./browser/lil")};n.node={embed:t("./node/request")};var o=r?n.browser:n.node;n.get=function(t){return t?o[t]:o.embed};n.defaults=function(){return n.get()};n.add=function(t,e){o[t]=e}},{"./browser/lil":1,"./node/request":3}],3:[function(t,e,n){e.exports=function(e,n,r){var o=t("request");e.json=true;return o(e,function(t,e,n){if(t)return r(t,e);if(n)e.body=n;r(t,e)})}},{request:19}],4:[function(t,e,n){var r=t("./request");var o=t("./builder");var i=t("./context");e.exports=s;function s(){this.name=null;this.parent=null;this.aliases=[];this.methods=[];this.resources=[];this.collections=[];this.ctx=new i}s.prototype=Object.create(r.prototype);s.prototype.alias=function(t){this.aliases.push(t);return this};s.prototype.collection=function(t){if(!(t instanceof s.Collection)){t=new s.Collection(t)}t.useParent(this);this.collections.push(t);return t};s.prototype.resource=function(t){if(!(t instanceof s.Resource)){t=new s.Resource(t)}t.useParent(this);this.resources.push(t);return t};s.prototype.resource=function(t){if(!(t instanceof s.Resource)){t=new s.Resource(t)}t.useParent(this);this.resources.push(t);return t};s.prototype.render=function(t){return new o(t||this).render()}},{"./builder":5,"./context":6,"./request":12}],5:[function(t,e,n){e.exports=r;function r(t){this.parent=t;this.client=new o(t)}r.prototype.render=function(){var t=this.parent;["collections","resources","methods"].forEach(function(e){t[e].forEach(this.renderMembers,this)},this);return this.client};r.prototype.renderMembers=function(t){var e=this.client;var n=t.name;if(!n)throw new TypeError("Render error: missing entity name");var r=[n].concat(t.aliases);r.forEach(function(n){if(e.hasOwnProperty(n))throw new Error('Name conflict: "'+n+'" is already defined');Object.defineProperty(e,n,{enumerable:true,configurable:false,get:function(){return t.render()},set:function(){throw new Error("Cannot override the property")}})})};function o(t){this._client=t}o.prototype._doRequest=function(t,e){};["GET","POST","PUT","PATCH","DELETE","HEAD","TRACE","OPTIONS"].forEach(function(t){o.prototype[t]=function(){return this._doRequest(t,arguments)}})},{}],6:[function(t,e,n){var r=t("midware");var o=t("./utils");var i=t("./agents");e.exports=s;function s(t){this.body=null;this.parent=null;this.body=null;this.opts={};this.query={};this.params={};this.headers={};this.cookies={};this.agentOpts=null;this.agent=i.defaults();this.mw={request:r(this),response:r(this)};this.validators={request:r(this),response:r(this)};if(t)this.useParent(t)}s.prototype.useParent=function(t){this.parent=t;this.setupMiddleware(t)};s.prototype.setupMiddleware=function(t){var e=this;["mw","validators"].forEach(function(n){["request","response"].forEach(function(r){e[n][r](function(){t[n][r].run.apply(e,arguments)})})})};s.prototype.get=function(){var t={};var e=this.opts;if(this.parent)t=this.parent.get();var n=t.basePath||"";var r=o.merge(t,e);r.basePath=n+(e.basePath||"");r.headers=o.merge(t.headers,this.headers);r.query=o.merge(t.query,this.query);r.params=o.merge(t.params,this.params);r.cookies=o.merge(t.cookies,this.cookies);r.agentOpts=o.merge(t.httpAgentOpts,this.httpAgentOpts);r.ctx=this;return r}},{"./agents":2,"./utils":16,midware:21}],7:[function(t,e,n){var r=t("./response");var o=t("./utils").series;e.exports=i;function i(t){this.ctx=t}i.prototype.run=function(t){t=t||a;var e=this.ctx.get();var n=new r(e);e.url=u(e);var i=[function c(t){this.before(e,n,t)},function p(t,e,n){this.dial(t,e,n)},function f(t,e,n){this.after(t,e,n)}];function s(e,n,r){if(e==="intercept")e=null;t(e,r)}o(i,s,this)};i.prototype.runPhase=function(t,e,n,r){var o=e.ctx;o.mw[t].run(e,n,function(i,s){if(i)return r(i,e,s||n);o.validators[t].run(e,n,function(t,o){r(t,e,o||n)})})};i.prototype.before=function(t,e,n){this.runPhase("request",t,e,n)};i.prototype.after=function(t,e,n){this.runPhase("response",t,e,n)};i.prototype.dial=function(t,e,n){t.ctx.agent(t,e,function(e,r){n(e,t,r)})};var s=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function u(t){var e=(t.basePath||"")+(t.path||"");while((res=s.exec(e))!=null){var n=res[3];if(n&&!t.params[n]){throw new Error("Missing required path param: "+n)}e=e.replace(":"+n,t.params[n])}return t.rootUrl+e}function a(){}},{"./response":13,"./utils":16}],8:[function(t,e,n){var r=t("../base");e.exports=o;function o(t){r.call(this);if(t)this.url(t)}o.prototype=Object.create(r.prototype);o.prototype.entity="client"},{"../base":4}],9:[function(t,e,n){var r=t("../base");e.exports=r.Collection=o;function o(t){r.call(this);this.name=t}o.prototype=Object.create(r.prototype);o.prototype.entity="collection"},{"../base":4}],10:[function(t,e,n){e.exports={Client:t("./client"),Resource:t("./resource"),Collection:t("./collection")}},{"./client":8,"./collection":9,"./resource":11}],11:[function(t,e,n){var r=t("../base");var o=t("../request");e.exports=r.Resource=i;function i(t){r.call(this);this.name=t}i.prototype=Object.create(r.prototype);i.prototype.entity="resource";i.prototype.render=function(){var t=this.ctx;var e=new o(t);return function(t,n){if(typeof t==="object")e.options(t);if(typeof t==="function")n=t;if(typeof n==="function")return e.end(n);return e}}},{"../base":4,"../request":12}],12:[function(t,e,n){var r=t("./types");var o=t("./context");var i=t("./dispatcher");var s=t("./utils").merge;e.exports=u;function u(t){this.parent=null;this.ctx=new o(t)}u.prototype.url=function(t){this.ctx.opts.rootUrl=t;return this};u.prototype.basePath=function(t){this.ctx.opts.basePath=t;return this};u.prototype.path=function(t){this.ctx.opts.path=t;return this};u.prototype.method=function(t){this.ctx.opts.method=t;return this};u.prototype.param=function(t,e){this.ctx.params[t]=e;return this};u.prototype.params=function(t){s(this.ctx.params,t);return this};u.prototype.unsetParam=function(t){delete this.ctx.params[t];return this};u.prototype.query=function(t){s(this.ctx.query,t);return this};u.prototype.queryParam=function(t,e){this.ctx.query[t]=e;return this};u.prototype.unsetQuery=function(t){delete this.ctx.query[t];return this};u.prototype.set=function(t,e){this.ctx.headers[t]=e;return this};u.prototype.unset=function(t){delete this.ctx.headers[t];return this};u.prototype.headers=function(t){s(this.ctx.headers,t)};u.prototype.type=function(t){this.ctx.headers["content-type"]=r[t]||t;return this};u.prototype.send=u.prototype.body=function(t){this.ctx.body=t;return this};u.prototype.cookie=function(t,e){this.ctx.cookies[t]=e;return this};u.prototype.unsetCookie=function(t){delete this.ctx.cookies[t];return this};u.prototype.use=function(t){this.ctx.mw.request(t);return this};u.prototype.useResponse=function(t){this.ctx.mw.response(t);return this};u.prototype.validate=u.prototype.validateRequest=function(t){this.ctx.validators.request(t);return this};u.prototype.validateResponse=function(t){this.ctx.validators.response(t);return this};u.prototype.end=function(t){return new i(this.ctx).run(t)};u.prototype.agent=function(t,e){if(typeof t!=="function")throw new TypeError("agent argument must be a function");this.ctx.agent=t;if(e)this.ctx.agentOpts=e;return this};u.prototype.agentOpts=function(t){this.ctx.agentOpts=t;return this};u.prototype.options=function(t){s(this.ctx.opts,t);return this};u.prototype.useParent=function(t){if(!(t instanceof u))throw new TypeError("Parent context is not a valid argument");this.parent=t;this.ctx.useParent(t.ctx);return this}},{"./context":6,"./dispatcher":7,"./types":15,"./utils":16}],13:[function(t,e,n){e.exports=r;function r(t){this.req=t;this.orig=this.body=this.json=this.type=null;this.headers={};this.typeParams={};this.status=this.statusType=this.statusCode=0;this.statusText=""}r.prototype.setOriginalResponse=function(t){this.orig=t};r.prototype.setBody=function(t){this.body=t;if(this.type==="json")this.json=t};r.prototype.get=function(t){return this.headers[t.toLowerCase()]};r.prototype.setHeaders=function(t){for(var e in t){this.headers[e.toLowerCase()]=t[e]}var n=this.headers["content-type"];if(n)this.setType(n)};r.prototype.setType=function(t){var e=t||"";this.type=i(e);var n=o(e);for(var r in n)this.typeParams[r]=n[r]};r.prototype.setStatus=function(t){if(t===1223)t=204;var e=t/100|0;this.statusType=e;this.status=this.statusCode=t;this.info=1==e;this.ok=2==e;this.clientError=4==e;this.serverError=5==e;this.error=4==e||5==e?this.toError():false;this.accepted=202==t;this.noContent=204==t;this.badRequest=400==t;this.unauthorized=401==t;this.notAcceptable=406==t;this.notFound=404==t;this.forbidden=403==t};r.prototype.setStatusText=function(t){this.statusText=t};r.prototype.toError=function(){var t=this.req;var e=t.method;var n=t.url;var r="cannot "+e+" "+n+" ("+this.status+")";var o=new Error(r);o.status=this.status;o.method=e;o.url=n;return o};function o(t){return t.split(/ *; */).reduce(function(t,e){var n=e.split(/ *= */),r=n.shift(),o=n.shift();if(r&&o)t[r]=o;return t},{})}function i(t){return t.split(/ *; */).shift()}},{}],14:[function(t,e,n){e.exports=r;function r(t){return new r.entities.Client(t)}r.Base=t("./base");r.Request=t("./request");r.Context=t("./context");r.Builder=t("./builder");r.entities=t("./entities");r.Dispatcher=t("./dispatcher");r.VERSION="0.1.0"},{"./base":4,"./builder":5,"./context":6,"./dispatcher":7,"./entities":10,"./request":12}],15:[function(t,e,n){e.exports={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"}},{}],16:[function(t,e,n){e.exports={merge:t("./merge"),series:t("./series")}},{"./merge":17,"./series":18}],17:[function(t,e,n){e.exports=function r(t,e){t=t||{};for(var n in e){t[n]=e[n]}return t}},{}],18:[function(t,e,n){var r=Array.prototype.slice;e.exports=function o(t,e,n){var o=t.slice();e=e||function(){};function i(t){if(t)return e.apply(n,arguments);var s=o.shift();if(!s)return e.apply(n,arguments);var u=r.call(arguments,1);s.apply(n,u.concat(i))}i()}},{}],19:[function(t,e,n){},{}],20:[function(e,n,r){(function(e,o){if(typeof t==="function"&&t.amd){t(["exports"],o)}else if(typeof r==="object"){o(r);if(typeof n==="object"&&n!==null){n.exports=r=r.http}}else{o(e.lil=e.lil||{})}})(this,function(t){"use strict";var e="0.1.16";var n=Object.prototype.toString;var r=Array.prototype.slice;var o=Object.prototype.hasOwnProperty;var i=typeof Function.prototype.bind==="function";var s=location.origin;var u=/^(http[s]?:\/\/[a-z0-9\-\.\:]+)[\/]?/i;var a=/application\/json/;var c=typeof XDomainRequest!=="undefined";var p=function(){};var f={method:"GET",timeout:30*1e3,auth:null,data:null,headers:null,withCredentials:false,responseType:"text"};function h(t){return t&&n.call(t)==="[object Object]"||false}function l(t){var e,n,i,s,u=r.call(arguments).slice(1);for(e=0,n=u.length;e<n;e+=1){s=u[e];for(i in s)if(o.call(s,i))t[i]=s[i]}return t}function d(t){var e=false;return function(){if(e===false){e=true;t.apply(null,arguments)}}}function y(t,e){if(h(e)){e["Content-Type"]=e["Content-Type"]||M.defaultContent;for(var n in e)if(o.call(e,n)){t.setRequestHeader(n,e[n])}}}function v(t){var e={},n=t.getAllResponseHeaders().trim().split("\n");n.forEach(function(t){var n=t.trim().split(":");var r=n.shift().trim();var o=n.join(":").trim();e[r]=o});return e}function m(t){return a.test(t.getResponseHeader("Content-Type"))}function x(t){return Object.getOwnPropertyNames(t).filter(function(e){return t[e]!==undefined}).map(function(e){var n=t[e]===null?"":t[e];return encodeURIComponent(e)+(n?"="+encodeURIComponent(n):"")}).join("&").replace(/%20/g,"+")}function g(t){var e=null;if(t.responseType==="text"){e=t.responseText;if(m(t)&&e)e=JSON.parse(e)}else{e=t.response}return e}function w(t){return t===1223?204:t}function b(t){var e={xhr:t,status:w(t.status),statusText:t.statusText,data:null,headers:{}};if(t.readyState===4){e.data=g(t);e.headers=v(t)}return e}function q(t,e){var n=b(t);n.error=e;if(e.stack)n.stack=e.stack;return n}function T(t){t.onreadystatechange=t.onerror=t.ontimeout=null}function E(t){var e=w(t.status);return e>=200&&e<300||e===304}function O(t,e){return d(function(n){e(q(t,n),null)})}function C(t,e,n){return function(t){if(e.readyState===4){T(e);if(E(e)){n(null,b(e))}else{O(e,n)(t)}}}}function P(t){var e=t.match(u);return e&&e[1]===s}function R(t){var e=t.url;if(h(t.params)){e+=(e.indexOf("?")===-1?"?":"&")+x(t.params)}return e}function j(t){if(c&&P(t)){return new XDomainRequest}else{return new XMLHttpRequest}}function S(t){var e=(t.method||"GET").toUpperCase();var n=t.auth;var r=R(t);var o=j(r);if(n){o.open(e,r,true,n.user,n.password)}else{o.open(e,r)}o.withCredentials=t.withCredentials;o.responseType=t.responseType;o.timeout=t.timeout;y(o,t.headers);return o}function k(t,e){return function(t){if(t.lengthComputable){e(t,t.loaded/t.total)}else{e(t)}}}function A(t){return t&&h(t.headers)&&(t.headers["content-type"]||t.headers["Content-Type"])||false}function H(t,e){var n=e.data;if(h(e.data)||Array.isArray(e.data)){if(A(e)===false){t.setRequestHeader("Content-Type","application/json")}n=JSON.stringify(e.data)}return n}function N(t,e){return function(){clearTimeout(e);t.apply(null,arguments)}}function D(t,e,n){var r=S(t);var o=H(r,t);var s=O(r,e);if(i){r.ontimeout=s}else{var u=setTimeout(function c(){if(r.readyState!==4){r.abort()}},t.timeout);e=N(e,u);s=O(r,e)}r.onreadystatechange=C(t,r,e);r.onerror=s;if(typeof n==="function"){r.onprogress=k(r,n)}try{r.send(o||null)}catch(a){s(a)}return{xhr:r,config:t}}function U(t){return function(e,n,o,i){var s,u,a=null;var c=l({},f,{method:t});var d=r.call(arguments);for(s=0,u=d.length;s<u;s+=1){a=d[s];if(typeof a==="function"){if(d.length===s+1&&typeof d[s-1]==="function"){i=a}else{o=a}}else if(h(a)){l(c,a)}else if(typeof a==="string"&&!c.url){c.url=a}}return D(c,o||p,i)}}function M(t,e,n,r){return U("GET").apply(null,arguments)}M.VERSION=e;M.defaults=f;M.defaultContent="text/plain";M.get=U("GET");M.post=U("POST");M.put=U("PUT");M.patch=U("PATCH");M.head=U("HEAD");M.delete=M.del=U("DELETE");return t.http=M})},{}],21:[function(e,n,r){(function(e,o){if(typeof t==="function"&&t.amd){t(["exports"],o)}else if(typeof r==="object"){o(r);if(typeof n==="object"&&n!==null){n.exports=r=r.midware}}else{o(e)}})(this,function(t){"use strict";function e(t){var e=r.stack=[];t=t||null;function r(){n(arguments).filter(function(t){return typeof t==="function"}).forEach(function(t){e.push(t)});return t}r.run=function o(){var r,o=n(arguments);if(typeof o[o.length-1]==="function"){r=o.pop()}if(!e.length){if(r)r.call(t);return}var i=e.slice();o.push(u);function s(){var e=i.shift();e.apply(t,o)}function u(e,n){if(e||n||!i.length){i=null;if(r)r.call(t,e,n)}else{s()}}s()};r.remove=function(t){for(var n=0,r=e.length;n<r;n+=1){var o=e[n];if(o===t||o.name===t){e.splice(n,1);break}}};r.flush=function(){e.splice(0)};return r}function n(t){var e=new Array(t.length);for(var n=0,r=e.length;n<r;n+=1){e[n]=t[n]}return e}e.VERSION="0.1.7";t.midware=e})},{}]},{},[14])(14)});
//# sourceMappingURL=http://cdn.rawgit.com/h2non/theon.js//theon.min.js.map
